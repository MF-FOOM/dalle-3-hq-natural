<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Generate HD Natural Images with DALL-E 3 API</title>
<style>
#progressBarContainer {
  width: 100%;
  background-color: #ddd;
  display: none; /* Hidden initially */
}

#progressBar {
  width: 0%;
  height: 30px;
  background-color: #4CAF50;
  text-align: center;
  line-height: 30px;
  color: white;
}</style>
</head>
<body>
<h1>Generate HD Natural Images with DALL-E 3 API</h1>
<div>
    <label for="apiKey">API Key:</label>
    <input type="text" id="apiKey" name="apiKey">
</div>
<div>
    <label for="prompt">Image Prompt:</label>
    <input type="text" id="prompt" name="prompt">
</div>
<button id="generateImage">Generate Image</button>
<div id="progressBarContainer">
  <div id="progressBar">0%</div>
</div>
<div id="imageResult"></div>

<script>
// Function to call the DALL-E 3 API and generate an image
async function generateImage(apiKey, prompt) {
    try {
        const response = await fetch('https://api.openai.com/v1/images/generations', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${apiKey}`
            },
            body: JSON.stringify({
                model: "dall-e-3",
                prompt: prompt,
                n: 1,
                size: "1792x1024",
                quality: "hd",
                style: "natural"
            })
        });

        const data = await response.json();
        return data;
    } catch (error) {
        console.error('Error generating image:', error);
        return null;
    }
}

function updateProgressBar(progressBar, value) {
    progressBar.style.width = value.toFixed(1) + '%'; // Round to one decimal place
    progressBar.textContent = value.toFixed(1) + '%'; // Display rounded value
}

document.getElementById('generateImage').addEventListener('click', async () => {
    const apiKey = document.getElementById('apiKey').value;
    const prompt = document.getElementById('prompt').value;
    const progressBarContainer = document.getElementById('progressBarContainer');
    const progressBar = document.getElementById('progressBar');
    const imageResultDiv = document.getElementById('imageResult');

    if (!apiKey) {
        alert("Please enter your API key.");
        return;
    }

    if (!prompt) {
        alert("Please enter a prompt for the image.");
        return;
    }

    // Show the progress bar container
    progressBarContainer.style.display = 'block';
    updateProgressBar(progressBar, 0);

    // Reset the result
    imageResultDiv.innerHTML = "";

    // Call the API and display the result
    const result = await generateImage(apiKey, prompt);
    if (result && result.data && result.data.length > 0) {
        imageResultDiv.innerHTML = `<img src="${result.data[0].url}" alt="Generated Image" style="max-width:100%; height:auto;" />`;
    } else {
        imageResultDiv.innerHTML = "No image was generated.";
    }

    // Hide the progress bar container
    progressBarContainer.style.display = 'none';
});

// Simulate progress bar update
function simulateProgress() {
    const progressBar = document.getElementById('progressBar');
    let progress = 0;
    const interval = setInterval(() => {
        if (progress < 100) {
            progress += (100 / 3500); // Increment the progress to reach 100% in 35 seconds
            updateProgressBar(progressBar, progress);
        } else {
            clearInterval(interval);
        }
    }, 10); // Update every 10 milliseconds
}

document.getElementById('generateImage').addEventListener('click', simulateProgress);</script>
</body>
</html>
