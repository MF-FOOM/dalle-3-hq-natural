<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DALL-E HD + Natural API</title>
<style>
#progressBarContainer {
  width: 100%;
  background-color: #ddd;
  display: none; /* Hide initially */
}

#progressBar {
  width: 0%;
  height: 30px;
  background-color: #4CAF50;
  text-align: center;
  line-height: 30px;
  color: white;
}</style>
</head>
<body>
<h1>Generate HD Natural Images with DALL-E 3 API</h1>
<div>
    <label for="apiKey">API Key:</label>
    <input type="text" id="apiKey" name="apiKey">
</div>
<div>
    <label for="prompt">Image Prompt:</label>
    <input type="text" id="prompt" name="prompt">
</div>
<button id="generateImage">Generate Image</button>
<div id="progressBarContainer">
  <div id="progressBar">0%</div>
</div>
<div id="imageResult"></div>

<script>
// Function to call the DALL-E 3 API and generate an image
async function generateImage(apiKey, prompt) {
    const response = await fetch('https://api.openai.com/v1/images/generations', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${apiKey}`
        },
        body: JSON.stringify({
            model: "dall-e-3",
            prompt: prompt,
            n: 1,
            size: "1792x1024",
            quality: "hd",
            style: "natural"
        })
    });

    const data = await response.json();
    return data;
}

function updateProgressBar(progressBar, value) {
    progressBar.style.width = value + '%';
    progressBar.textContent = value + '%';
}

document.getElementById('generateImage').addEventListener('click', async () => {
    const apiKey = document.getElementById('apiKey').value;
    const prompt = document.getElementById('prompt').value;
    const progressBarContainer = document.getElementById('progressBarContainer');
    const progressBar = document.getElementById('progressBar');
    const imageResultDiv = document.getElementById('imageResult');

    if (!apiKey) {
        alert("Please enter your API key.");
        return;
    }

    if (!prompt) {
        alert("Please enter a prompt for the image.");
        return;
    }

    // Show the progress bar container
    progressBarContainer.style.display = 'block';

    // Reset the progress bar and result
    updateProgressBar(progressBar, 0);
    imageResultDiv.innerHTML = "";

    // Simulate a faster load time for the progress bar
    let progress = 0;
    const interval = setInterval(() => {
        progress += 1; // Increment progress by 1% every 200ms
        updateProgressBar(progressBar, progress);
        if (progress >= 100) {
            clearInterval(interval);
            // Hide the progress bar container after reaching 100%
            progressBarContainer.style.display = 'none';
        }
    }, 200); // Update every 200 milliseconds

    // Call the API and display the result after 20 seconds
    setTimeout(async () => {
        try {
            const result = await generateImage(apiKey, prompt);
            if (result.data && result.data.length > 0) {
                imageResultDiv.innerHTML = `<img src="${result.data[0].url}" alt="Generated Image" style="max-width:100%; height:auto;" />`;
            } else {
                imageResultDiv.innerHTML = "No image was generated.";
            }
        } catch (error) {
            console.error('Error generating image:', error);
            imageResultDiv.innerHTML = "Error generating image. Please check the console for more information.";
        }
        // Hide the progress bar container after the image is generated
        progressBarContainer.style.display = 'none';
    }, 20000); // Wait for 20 seconds before calling the API
});</script>
</body>
</html>
